# JPX適時開示情報テーブル構造調査結果

## 概要
東京証券取引所（JPX）の適時開示情報ページにおけるHTMLテーブル構造を詳細調査し、各URL（PDF、XBRL、HTMLサマリー、添付資料）の正確な位置を特定しました。

## 調査対象
- **対象企業**: ソフトバンクグループ（証券コード: 99840）
- **調査日**: 2025年8月21日
- **調査ファイル**: 2026年3月期第1四半期決算短信〔IFRS〕（連結）

## テーブル構造

### ヘッダー構造
```html
<tr>
    <th rowspan="2">開示日</th>
    <th rowspan="2">表題</th>
    <th rowspan="2">XBRL</th>
    <th colspan="2">HTML</th>
</tr>
<tr>
    <th>サマリー</th>
    <th>添付資料</th>
</tr>
```

### データ行構造（td要素の配置）

| 列番号 | 項目 | 内容 | URL取得方法 | サンプルURL |
|--------|------|------|-------------|-------------|
| 1 | 開示日 | `2025/08/07` | テキストのみ | - |
| 2 | 表題 | PDF URLを含むリンク | `<a href="...">` | `https://www2.jpx.co.jp/disc/99840/140120250805531214.pdf` |
| 3 | **XBRL** | XBRLファイル（ZIP） | `<img onclick="...">` | `https://www2.jpx.co.jp/disc/99840/081220250805531214.zip` |
| 4 | **HTMLサマリー** | iXBRLファイル | `<a href="...">` | `https://www2.jpx.co.jp/disc/99840/081220250805531214_tse-qcedifsm-99840-20250807399840-ixbrl.htm` |
| 5 | **添付資料** | 定性的情報等 | `<a href="...">` | `https://www2.jpx.co.jp/disc/99840/081220250805531214_qualitative.htm` |

## 詳細な実装

### 1. 開示日（1列目）
```html
<td align="center">2025/08/07</td>
```
- **取得方法**: `td.get_text().strip()`

### 2. 表題・PDF URL（2列目）
```html
<td>
    <div class="txtLink2">
        <div class="txtLink2_InnerDiv">
            <a href="/disc/99840/140120250805531214.pdf" target="linkWin9_1">
                2026年３月期 第１四半期決算短信〔ＩＦＲＳ〕（連結）
            </a>
        </div>
    </div>
</td>
```
- **取得方法**: `a.get('href')` + `a.get_text().strip()`

### 3. XBRL URL（3列目）
```html
<td align="center">
    <img src="/common/images/icon_xbrl.gif" class="cursorHand" alt="XBRL" 
         onclick="doDownload(document.forms['JJK010040Form'],
                 document.forms['JJK010040Form'].XBRLDownload,
                 '/99840/081220250805531214.zip');"/>
</td>
```
- **取得方法**: `onclick`属性から`'/99840/081220250805531214.zip'`を抽出
- **URL生成**: `https://www2.jpx.co.jp/disc` + 抽出したパス

### 4. HTMLサマリー URL（4列目）
```html
<td align="center">
    <a href="/disc/99840/081220250805531214_tse-qcedifsm-99840-20250807399840-ixbrl.htm" 
       target="linkWin7_2">
        <img src="/common/images/icon_html_03.gif" alt="HTMLファイル" />
    </a>
</td>
```
- **取得方法**: `a.get('href')`
- **ファイル形式**: インラインXBRL（.ixbrl.htm）

### 5. 添付資料 URL（5列目）
```html
<td align="center">
    <a href="/disc/99840/081220250805531214_qualitative.htm" 
       target="linkWin7_2">
        <img src="/common/images/icon_html_03.gif" alt="HTMLファイル" />
    </a>
</td>
```
- **取得方法**: `a.get('href')`
- **ファイル形式**: 定性的情報HTML（.qualitative.htm）

## コード実装での注意点

### 修正前の誤解
- HTMLサマリーが3列目だと思い込んでいた
- XBRLが4列目だと思い込んでいた

### 修正後の正しい理解
- XBRL（ZIP）は3列目、`onclick`属性で取得
- HTMLサマリー（iXBRL）は4列目、`href`属性で取得
- 添付資料は5列目、`href`属性で取得

## テーブルID情報
適時開示情報は複数のテーブルに分散されており、以下のIDパターンで識別される：
- `closeUpKaiJi0` - 決算短信等の主要開示情報
- `closeUpKaiJi52` - その他の開示情報
- `closeUpKaiJi422`, `closeUpKaiJi423` - 追加の開示情報

## ファイル形式とURL規則

### PDF
- **パターン**: `140120250805531214.pdf`
- **用途**: 決算短信のPDF版

### XBRL（ZIP）
- **パターン**: `081220250805531214.zip`
- **用途**: 構造化された財務データ（XBRL形式）

### HTMLサマリー（iXBRL）
- **パターン**: `081220250805531214_tse-qcedifsm-99840-20250807399840-ixbrl.htm`
- **用途**: HTMLとXBRLが統合されたインラインXBRL

### 添付資料
- **パターン**: `081220250805531214_qualitative.htm`
- **用途**: 定性的情報（業績予想、事業環境等）

## まとめ
この調査により、JPX適時開示情報テーブルから以下の情報を正確に抽出できることが確認されました：
1. ✅ PDF URL（決算短信）
2. ✅ XBRL URL（財務データ）
3. ✅ HTMLサマリー URL（インラインXBRL）
4. ✅ 添付資料 URL（定性的情報）

すべてのURLが正しく取得できるため、財務情報の自動収集・分析システムの構築が可能です。